"use strict";(self.webpackChunkrlc=self.webpackChunkrlc||[]).push([[343],{343:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=s(216),n=s(43),l=s(475),r=(s(785),s(668)),o=s(579);(0,r.hn)({locale:r.TZ,theme:"ios",themeVariant:"light"});const i=function(){const[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)([]),[i,c]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[d,h]=(0,n.useState)([]),w=(0,a.zy)(),{teacherDate:T}=w.state||{},{level:f}=w.state||{},{allTeachers:g}=w.state||{},p=e=>{const t=e.map((e=>new Date(e))).sort(((e,t)=>e-t)),s=[];let a=null;return t.forEach((e=>{a?e<=a[1]?a[1]=new Date(Math.max(a[1],e)):(s.push(a),a=[e,e]):a=[e,e]})),a&&s.push(a),s.map((e=>{let[t]=e;return{start:t}}))},D=(e,t)=>{t=t.map((e=>{const t=new Date(e.start.getTime()-108e5);return{...e,time:t}})).sort(((e,t)=>new Date(e.time)-new Date(t.time)));const s=[],a=new Date(new Date(t[0].time).setUTCHours(0,0,0,0)),n=new Date(t[0].time);a<n&&s.push({start:a,end:new Date(n.getTime()-6e4)});for(let i=0;i<t.length;i++){const e=new Date(t[i].time);if(0===t[i].slots){const a=i<t.length-1?new Date(t[i+1].time):new Date(e.setUTCHours(23,59,0,0));s.push({start:e,end:new Date(a.getTime()-6e4)})}else if(i>0&&0!==t[i-1].slots){const a=new Date(t[i-1].time);a<e&&s.push({start:new Date(a.getTime()+36e5-186e4),end:new Date(e.getTime()-6e4)})}}const l=new Date(t[t.length-1].time),r=new Date(l);r.setUTCHours(23,59,0,0),l<r&&s.push({start:new Date(l.getTime()+36e5-186e4),end:r});const o=[...s];return Array.from(new Set(o.map((e=>`${e.start}-${e.end}`)))).map((e=>{const[t,s]=e.split("-");return{start:new Date(t),end:new Date(s)}}))},k=(0,n.useCallback)((()=>{const e=[],t=[];d.forEach((s=>{const a=new Date(s.d),n=new Date(a.getTime()+6e4*a.getTimezoneOffset());s.allSlots>0?(t.push({start:n,title:s.allSlots+" SPOTS",textColor:"#e1528f"}),e.push(...s.nonWorkTime)):e.push(n)})),c(t),u(e)}),[d]);(0,n.useEffect)((()=>{(async()=>{try{if(T){const e=T[0].level.filter((e=>e.levelName===f));e[0].date.forEach((e=>{e.allSlots=e.workTime.reduce(((e,t)=>e+t.slots),0)})),h(e[0].date)}else if(g){g.forEach((e=>{e.allSlots=e.workTime.reduce(((e,t)=>e+t.slots),0)}));const e=(e=>{const t=e.reduce(((e,t)=>{const s=t.d;return e[s]?(e[s].workTime=[...e[s].workTime,...t.workTime],e[s].nonWorkTime=[...new Set([...e[s].nonWorkTime,...t.nonWorkTime])],e[s].allSlots+=t.allSlots||0):e[s]={...t,workTime:[...t.workTime],nonWorkTime:[...t.nonWorkTime],allSlots:t.allSlots||0},e}),{});return Object.values(t).map((e=>{const t=[];e.workTime.forEach((s=>{console.log(e),s.slots>0&&t.push(s.time)}));const s=p(t),a=D(e.nonWorkTime,s);return{...e,workTime:s,nonWorkTime:a,allSlots:e.allSlots}}))})(g);h(e)}const e=localStorage.getItem("selectedDates");e&&l(JSON.parse(e))}catch(e){console.error("Failed to fetch bookings",e)}})()}),[]),(0,n.useEffect)((()=>{k()}),[d,k]),(0,n.useEffect)((()=>{localStorage.setItem("selectedDates",JSON.stringify(e))}),[e]);const S=(0,n.useCallback)((e=>{let t=e.value;null===t?l([]):t instanceof Date?l([t]):Array.isArray(t)?l(t):(console.error("Unexpected type for 'args.value':",t),l([]))}),[]),x=e=>new Date(e).toLocaleString("uk-UA",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,o.jsxs)(r.YW,{className:"md-calendar-booking",children:[(0,o.jsxs)("div",{className:"mbsc-form-group",children:[(0,o.jsx)("div",{className:"mbsc-form-group-title",children:"Select date & time"}),(0,o.jsx)(r.t1,{display:"inline",controls:["calendar","timegrid"],min:"2024-09-01T00:00",max:"2024-09-11T00:00",minTime:"05:00",maxTime:"23:59",stepMinute:30,width:null,labels:i,invalid:m,onPageLoading:k,cssClass:"booking-datetime",onChange:S,multiple:!0}),(0,o.jsx)("button",{onClick:()=>{Array.isArray(s)?t((e=>[...e,...s.map(x)])):console.error("Expected 'multiple' to be an array, but got:",typeof s)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u0442\u044b \u0438 \u0432\u0440\u0435\u043c\u044f"})]}),(0,o.jsxs)("div",{className:"selected-dates",children:[(0,o.jsx)("h3",{children:"Selected Dates & Times:"}),Array.isArray(e)&&e.length>0?(0,o.jsx)("ul",{children:e.map(((e,s)=>(0,o.jsxs)("li",{children:[e,(0,o.jsx)("button",{onClick:()=>{return s=e,void t((e=>e.filter((e=>e!==s))));var s},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]},s)))}):(0,o.jsx)("p",{children:"No dates selected."})]})]})},c=()=>{const[e,t]=(0,n.useState)(null),s=(0,a.zy)(),{teacherDate:r}=s.state||{},{level:c}=s.state||{},{allTeachers:m}=s.state||{},{lang:u}=s.state||{},{teacherId:d}=s.state||{};return(0,n.useEffect)((()=>{r?t(r[0].lang):m&&t(u[0])}),[]),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u0434\u0430\u0442\u0443"}),(0,o.jsx)(l.N_,{to:m?"/teacher":r?"/final":void 0,state:{lingua:e,level:c,teacherId:d},children:(0,o.jsx)("button",{children:"\u0414\u0430\u043b\u0456"})}),(0,o.jsx)(i,{})]})}}}]);
//# sourceMappingURL=343.56c847b4.chunk.js.map